name: "Xiaomi Mi A2"
codename: "jasmine_sprout"
formfactor: "phone"
aliases: []
doppelgangers: []
user_actions:
  confirm_model:
    title: "Confirm your model"
    description: "Please double-check that your device is a Xiaomi Mi A2 (jasmine_sprout). Xiaomi Mi 6x and Xiaomi Mi A2 Lite are NOT SUPPORTED."
  confirm_os:
    title: "Confirm OS version"
    description: "Your device must be running a custom OS build before installing Ubuntu Touch. You can use the link below to download it. You can use TWRP recovery to flash it. Flash it to both A and B slots to be safe."
    link: "https://github.com/ubports-xiaomi-sdm660/artifacts/releases/download/20211023/UBTouch-jasmine_sprout-23-10-2021.zip"
  warning:
    title: "Warning"
    description: "For unknown reason some pc may not work with device fastboot mode, if installer fails or bootloop your device try to run it from other pc"
  bootloader:
    title: "Reboot to Bootloader"
    description: "With the device powered off, press and hold the VOLUME DOWN and POWER buttons until the screen turns on"
    image: "phone_power_down"
    button: true
  recovery:
    title: "Reboot to Recovery"
    description: "With the device still at the 'Fastboot Mode' screen and press and hold VOLUME UP and POWER buttons until the screen turns on"
    image: "phone_power_up"
    button: true
unlock:
  - "confirm_model"
  - "confirm_os"
  - "warning"
handlers:
  bootloader_locked:
    actions:
      - fastboot:flashing_unlock:
operating_systems:
  - name: "Ubuntu Touch"
    options:
      - var: "channel"
        name: "Channel"
        tooltip: "The release channel"
        link: "https://docs.ubports.com/en/latest/about/process/release-schedule.html"
        type: "select"
        remote_values:
          systemimage:channels:
      - var: "wipe"
        name: "Wipe Userdata"
        tooltip: "Wipe personal data"
        type: "checkbox"
      - var: "bootstrap"
        name: "Bootstrap"
        tooltip: "Flash system partitions using fastboot"
        type: "checkbox"
        value: true
    prerequisites: []
    steps:
      - actions:
          - core:download:
              group: "firmware"
              files:
                - name: "boot.img"
                  url: "https://github.com/ubports-xiaomi-sdm660/artifacts/releases/download/20211023/boot.img"
                  checksum:
                    sum: "75fd5840f9f18903545695eb9e137915faa0d7848bef0bb290e118578f2429dc"
                    algorithm: "sha256"
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - adb:reboot:
              to_state: "bootloader"
        fallback:
          - core:user_action:
              action: "bootloader"
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - fastboot:format:
              partition: "system"
              type: "ext4"
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - fastboot:format:
              partition: "cache"
              type: "ext4"
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - fastboot:format:
              partition: "userdata"
              type: "ext4"
        condition:
          var: "wipe"
          value: true
      - actions:
          - fastboot:flash:
              partitions:
                - partition: "boot"
                  file: "boot.img"
                  group: "firmware"
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - adb:reboot:
              to_state: "recovery"
        fallback:
          - core:user_action:
              action: "recovery"
      - actions:
          - systemimage:install:
      - actions:
          - adb:reboot:
              to_state: "recovery"
        fallback:
          - core:user_action:
              action: "recovery"
    slideshow: []
